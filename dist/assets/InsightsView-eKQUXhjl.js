import{c as ie,x as le,y as de,a as b,K as H,T as E,L as ce,b as r,e as c,h as w,j as m,f as o,F as p,d as e,i as v,g as f,l as x,n as P,M as ue,o as n,N as q,t as l,q as _,s as $,J as L}from"./index-CsJlV2NR.js";import{u as me}from"./useMedicalRecord-vD1b8KYH.js";import{u as ge,S as pe}from"./useMedicationInteractions-Br9Y5Fpr.js";import{_ as y}from"./BaseCard-DC-Hfjqs.js";import{T as O}from"./trending-down-D-jjVdaA.js";import{P as Q,B as xe}from"./pill-Caw8L6MW.js";import{I as J}from"./info-BbO_qJPN.js";import{A as z}from"./activity-D1Tnhn21.js";import{M as fe,B as ye,T as he}from"./thermometer-ChLoOecQ.js";import{F as be}from"./frown-CCVKL6KV.js";const ve=ie("stethoscope",[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]]),_e={class:"space-y-6 animate-fade-in"},we={class:"flex items-center gap-4"},ke={class:"w-14 h-14 rounded-xl bg-white/20 flex items-center justify-center"},Se={class:"text-teal-100"},Ce={"aria-labelledby":"insights-title"},De={class:"grid gap-4"},Me={class:"flex items-start gap-4"},je={class:"font-semibold text-gray-900"},Ie={class:"text-gray-600 mt-1"},Ae={key:0,"aria-labelledby":"medication-analysis-title"},Te={id:"medication-analysis-title",class:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2"},Ee={class:"space-y-3"},$e={class:"flex items-start gap-3"},ze={class:"w-10 h-10 rounded-lg bg-amber-100 flex items-center justify-center shrink-0"},Fe={class:"flex-1"},Ve={class:"flex items-center gap-2 mb-1"},Be={class:"font-semibold text-gray-900"},Ne={class:"px-2 py-0.5 text-xs font-medium bg-gray-100 text-gray-600 rounded-full"},Re={class:"space-y-1"},We={class:"font-medium"},He={key:0,class:"ml-1 text-xs"},Pe={class:"text-xs mt-0.5 opacity-80"},qe={class:"text-xs text-gray-500 mt-3 flex items-center gap-1"},Le={key:1,"aria-labelledby":"active-alerts-title"},Oe={id:"active-alerts-title",class:"text-lg font-semibold text-amber-700 mb-4 flex items-center gap-2"},Qe={class:"space-y-2"},Je={class:"font-medium text-gray-900 text-sm"},Ke={class:"text-xs text-gray-600 mt-1"},Ue={key:2,"aria-labelledby":"condition-insights-title"},Ge={id:"condition-insights-title",class:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2"},Xe={class:"grid gap-4"},Ye={class:"flex items-start gap-4"},Ze={class:"w-12 h-12 rounded-xl bg-teal-100 flex items-center justify-center shrink-0"},et={class:"flex-1"},tt={class:"flex flex-wrap gap-2"},st={class:"flex items-start gap-4"},at={class:"w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center shrink-0"},nt={class:"font-semibold text-gray-900"},ot={class:"text-gray-600 mt-1"},rt={class:"flex items-center gap-4 mb-4"},it={class:"text-center"},lt={class:"text-2xl font-bold text-teal-600"},dt={class:"space-y-3"},ct={key:0},ut={class:"flex flex-wrap gap-2"},mt={key:1},gt={class:"flex flex-wrap gap-2"},pt={class:"flex items-center gap-4"},xt={class:"w-12 h-12 rounded-xl bg-purple-100 flex items-center justify-center shrink-0"},ft={class:"flex-1"},yt={class:"text-gray-600 text-sm mt-1"},ht={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},bt={key:0,class:"text-center py-6 text-gray-500"},vt={key:1,class:"space-y-4"},_t={class:"flex-1"},wt={class:"flex items-center justify-between mb-1"},kt={class:"font-medium text-gray-900"},St={class:"text-sm text-gray-500"},Ct={class:"h-2 bg-gray-100 rounded-full overflow-hidden"},Dt={class:"flex justify-between gap-2"},Mt={class:"w-full h-32 flex items-end justify-center"},jt={class:"text-xs text-gray-600 font-medium mt-2"},It={class:"text-xs text-gray-400"},At={class:"flex items-center gap-6"},Tt={class:"flex-1 text-center p-4 bg-gray-50 rounded-xl"},Et={class:"text-3xl font-bold text-gray-900"},$t={class:"flex flex-col items-center"},zt={class:"flex-1 text-center p-4 bg-teal-50 rounded-xl"},Ft={class:"text-3xl font-bold text-teal-700"},Vt={id:"tips-title",class:"text-lg font-semibold text-gray-900 flex items-center gap-2"},Kt={__name:"InsightsView",setup(Bt){const{symptoms:k,stats:S,refreshSymptoms:K}=le();de(()=>{K()});const{userDiseases:I,expectedSymptoms:F,isSymptomRelatedToConditions:U,getRelatedDiseases:G,medicalRecord:V}=me(),{analyzeAllSymptoms:X,activeAlerts:B}=ge(),Y={Frown:be,Thermometer:he,Pill:Q,Battery:ye,Brain:xe,Moon:fe},Z={red:"bg-red-100 text-red-600",orange:"bg-orange-100 text-orange-600",yellow:"bg-yellow-100 text-yellow-600",blue:"bg-blue-100 text-blue-600",purple:"bg-purple-100 text-purple-600",teal:"bg-teal-100 text-teal-600",indigo:"bg-indigo-100 text-indigo-600",gray:"bg-gray-100 text-gray-600"},C=b(()=>S.value.typeStats.filter(a=>a.count>0).sort((a,t)=>t.count-a.count)),g=b(()=>{const a=new Date,t=new Date(a);t.setDate(a.getDate()-7);const i=new Date(t);i.setDate(i.getDate()-7);const s=k.value.filter(T=>{const M=new Date(T.date);return M>=t&&M<=a}),u=k.value.filter(T=>{const M=new Date(T.date);return M>=i&&M<t}),d=s.length,h=u.length;let A="stable",j=0;return h>0&&(j=Math.round((d-h)/h*100),j>10?A="up":j<-10&&(A="down")),{thisWeekCount:d,lastWeekCount:h,trend:A,percentage:Math.abs(j)}}),N=b(()=>{const a={};return k.value.forEach(i=>{const s=parseInt(i.time?.split(":")[0]||0);a[s]=(a[s]||0)+1}),Object.entries(a).sort((i,s)=>s[1]-i[1]).slice(0,3).map(([i,s])=>({hour:parseInt(i),count:s,label:`${i.padStart(2,"0")}:00 - ${(parseInt(i)+1).toString().padStart(2,"0")}:00`}))}),ee=b(()=>{const a={0:{name:"Domingo",count:0},1:{name:"Segunda",count:0},2:{name:"Terça",count:0},3:{name:"Quarta",count:0},4:{name:"Quinta",count:0},5:{name:"Sexta",count:0},6:{name:"Sábado",count:0}};k.value.forEach(i=>{const s=(i.date||"").split("T")[0].split(" ")[0];if(!s)return;const u=new Date(s+"T12:00:00").getDay();isNaN(u)||a[u].count++});const t=Math.max(...Object.values(a).map(i=>i.count));return Object.values(a).map(i=>({...i,percentage:t>0?Math.round(i.count/t*100):0}))}),te=b(()=>{const a=[];if(parseFloat(S.value.avgIntensity)>=4&&a.push({type:"warning",icon:H,title:"Intensidade elevada",description:"A maioria dos seus sintomas tem intensidade alta. Considere consultar um profissional de saúde."}),C.value.length>0){const t=C.value[0];a.push({type:"info",icon:E,title:"Sintoma mais frequente",description:`${t.label} é o sintoma que você mais registra (${t.count} vezes).`})}if(g.value.trend==="up"?a.push({type:"warning",icon:E,title:"Aumento de sintomas",description:`Você registrou ${g.value.percentage}% mais sintomas esta semana comparado à semana anterior.`}):g.value.trend==="down"&&a.push({type:"success",icon:O,title:"Redução de sintomas",description:`Ótima notícia! Você registrou ${g.value.percentage}% menos sintomas esta semana.`}),N.value.length>0){const t=N.value[0];a.push({type:"info",icon:ce,title:"Horário de pico",description:`Seus sintomas são mais frequentes entre ${t.label}.`})}return a}),se=a=>{const t={info:"bg-blue-50 border-blue-200",warning:"bg-amber-50 border-amber-200",success:"bg-green-50 border-green-200"};return t[a]||t.info},ae=a=>{const t={info:"bg-blue-100 text-blue-600",warning:"bg-amber-100 text-amber-600",success:"bg-green-100 text-green-600"};return t[a]||t.info},R={dor:"Dor",enjoo:"Enjoo",fadiga:"Fadiga",ansiedade:"Ansiedade",insonia:"Insônia",febre:"Febre"},ne=b(()=>{const a=[];return I.value.length===0||C.value.forEach(t=>{const i=U(t.id),s=G(t.id);i&&s.length>0&&a.push({type:"condition",symptom:t.label,symptomId:t.id,count:t.count,diseases:s.map(u=>u.name)})}),a}),D=b(()=>{if(F.value.length===0)return null;const a=F.value.map(d=>d.symptom),t=C.value.map(d=>d.id),i=a.filter(d=>t.includes(d)),s=a.filter(d=>!t.includes(d)),u=t.filter(d=>!a.includes(d));return{matching:i,notRegistered:s,unexpected:u,matchPercentage:a.length>0?Math.round(i.length/a.length*100):0}}),oe={mental:"purple",cardiovascular:"red",respiratory:"blue",endocrine:"orange",neurological:"indigo",musculoskeletal:"green",gastrointestinal:"yellow",dermatological:"pink",immunological:"teal",other:"gray"},re=a=>{const t={purple:"bg-teal-100 text-teal-700 border-teal-200",red:"bg-red-100 text-red-700 border-red-200",blue:"bg-blue-100 text-blue-700 border-blue-200",orange:"bg-orange-100 text-orange-700 border-orange-200",indigo:"bg-indigo-100 text-indigo-700 border-indigo-200",green:"bg-green-100 text-green-700 border-green-200",yellow:"bg-yellow-100 text-yellow-700 border-yellow-200",pink:"bg-pink-100 text-pink-700 border-pink-200",teal:"bg-teal-100 text-teal-700 border-teal-200",gray:"bg-gray-100 text-gray-700 border-gray-200"};return t[oe[a]]||t.gray},W=b(()=>{const a=V.value?.medications||[];if(a.length===0||k.value.length===0)return null;const t=new Date,i=new Date(t);i.setDate(t.getDate()-7);const s=k.value.filter(d=>{const h=new Date(d.date);return h>=i&&h<=t});if(s.length===0)return null;const u=X(s,a);return u.length>0?u:null});return b(()=>(V.value?.medications||[]).length>0),(a,t)=>{const i=ue("router-link");return n(),r("div",_e,[c(o(y),{variant:"gradient",class:"!bg-gradient-to-r !from-teal-600 !to-cyan-600 !text-white"},{default:m(()=>[e("div",we,[e("div",ke,[c(o(q),{class:"w-7 h-7","aria-hidden":"true"})]),e("div",null,[t[0]||(t[0]=e("h2",{class:"text-2xl font-bold text-white"},"Seus Insights",-1)),e("p",Se," Análise personalizada baseada em "+l(o(S).total)+" registros ",1)])])]),_:1}),o(S).total===0?(n(),w(o(y),{key:0,class:"text-center py-12"},{default:m(()=>[c(o(z),{class:"w-16 h-16 text-gray-300 mx-auto mb-4","aria-hidden":"true"}),t[1]||(t[1]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"}," Sem dados suficientes ",-1)),t[2]||(t[2]=e("p",{class:"text-gray-500 max-w-md mx-auto"}," Registre alguns sintomas para começar a ver insights personalizados sobre sua saúde. ",-1))]),_:1})):(n(),r(p,{key:1},[e("section",Ce,[t[3]||(t[3]=e("h2",{id:"insights-title",class:"text-lg font-semibold text-gray-900 mb-4"}," Observações Importantes ",-1)),e("div",De,[(n(!0),r(p,null,f(te.value,(s,u)=>(n(),r("article",{key:u,class:_(["p-4 rounded-xl border-2",se(s.type)])},[e("div",Me,[e("div",{class:_(["w-10 h-10 rounded-lg flex items-center justify-center shrink-0",ae(s.type)])},[(n(),w($(s.icon),{class:"w-5 h-5","aria-hidden":"true"}))],2),e("div",null,[e("h3",je,l(s.title),1),e("p",Ie,l(s.description),1)])])],2))),128))])]),W.value?(n(),r("section",Ae,[e("h2",Te,[c(o(Q),{class:"w-5 h-5 text-blue-600","aria-hidden":"true"}),t[4]||(t[4]=x(" Possiveis Efeitos dos Medicamentos ",-1))]),e("div",Ee,[(n(!0),r(p,null,f(W.value,(s,u)=>(n(),w(o(y),{key:u,class:"!p-4"},{default:m(()=>[e("div",$e,[e("div",ze,[c(o(pe),{class:"w-5 h-5 text-amber-600","aria-hidden":"true"})]),e("div",Fe,[e("div",Ve,[e("h3",Be,l(s.symptomLabel),1),e("span",Ne,l(s.count)+"x esta semana ",1)]),t[5]||(t[5]=e("p",{class:"text-sm text-gray-600 mb-2"}," Este sintoma pode estar relacionado aos seus medicamentos: ",-1)),e("div",Re,[(n(!0),r(p,null,f(s.possibleCauses,(d,h)=>(n(),r("div",{key:h,class:_(["text-sm p-2 rounded-lg flex items-start gap-2",d.likelihood==="interaction"?"bg-red-50 text-red-700":"bg-blue-50 text-blue-700"])},[c(o(J),{class:"w-4 h-4 mt-0.5 shrink-0","aria-hidden":"true"}),e("div",null,[e("span",We,l(d.medication),1),d.severity?(n(),r("span",He," ("+l(d.severity==="high"?"risco alto":d.severity==="moderate"?"risco moderado":"risco baixo")+") ",1)):v("",!0),e("p",Pe,l(d.description),1)])],2))),128))])])])]),_:2},1024))),128))]),e("p",qe,[c(o(J),{class:"w-3 h-3"}),t[6]||(t[6]=x(" Essas informações são apenas sugestivas. Consulte seu médico antes de fazer alterações. ",-1))])])):v("",!0),o(B).length>0?(n(),r("section",Le,[e("h2",Oe,[c(o(H),{class:"w-5 h-5","aria-hidden":"true"}),t[7]||(t[7]=x(" Alertas de Interação Medicamentosa ",-1))]),e("div",Qe,[(n(!0),r(p,null,f(o(B),s=>(n(),r("div",{key:s.id,class:_(["p-3 rounded-lg border-l-4",s.severity==="high"?"bg-red-50 border-red-500":s.severity==="moderate"?"bg-amber-50 border-amber-500":"bg-blue-50 border-blue-500"])},[e("p",Je,l(s.medications?.join(" + ")),1),e("p",Ke,l(s.description),1)],2))),128))])])):v("",!0),o(I).length>0?(n(),r("section",Ue,[e("h2",Ge,[c(o(P),{class:"w-5 h-5 text-teal-600","aria-hidden":"true"}),t[8]||(t[8]=x(" Análise das Suas Condições ",-1))]),e("div",Xe,[c(o(y),{class:"!bg-gradient-to-r !from-teal-50 !to-cyan-50 !border-teal-100"},{default:m(()=>[e("div",Ye,[e("div",Ze,[c(o(ve),{class:"w-6 h-6 text-teal-600","aria-hidden":"true"})]),e("div",et,[t[9]||(t[9]=e("h3",{class:"font-semibold text-gray-900 mb-2"},"Suas Condições de Saúde",-1)),e("div",tt,[(n(!0),r(p,null,f(o(I),s=>(n(),r("span",{key:s.id,class:_(["px-3 py-1 rounded-full text-sm font-medium border",re(s.category)])},l(s.name),3))),128))])])])]),_:1}),(n(!0),r(p,null,f(ne.value,s=>(n(),r("article",{key:s.symptomId,class:"p-4 rounded-xl border-2 bg-purple-50 border-purple-200"},[e("div",st,[e("div",at,[c(o(z),{class:"w-5 h-5 text-purple-600","aria-hidden":"true"})]),e("div",null,[e("h3",nt,l(s.symptom)+" relacionado às suas condições ",1),e("p",ot,[t[10]||(t[10]=x(" Você registrou ",-1)),e("strong",null,l(s.count),1),x(" episódios de "+l(s.symptom.toLowerCase())+". Este sintoma é comum em: ",1),e("strong",null,l(s.diseases.join(", ")),1),t[11]||(t[11]=x(". ",-1))])])])]))),128)),D.value?(n(),w(o(y),{key:0},{default:m(()=>[e("div",rt,[t[13]||(t[13]=e("div",{class:"flex-1"},[e("h3",{class:"font-semibold text-gray-900"},"Correspondência de Sintomas"),e("p",{class:"text-sm text-gray-500"}," Comparação entre sintomas esperados e registrados ")],-1)),e("div",it,[e("div",lt,l(D.value.matchPercentage)+"% ",1),t[12]||(t[12]=e("div",{class:"text-xs text-gray-500"},"correspondência",-1))])]),e("div",dt,[D.value.matching.length>0?(n(),r("div",ct,[t[14]||(t[14]=e("p",{class:"text-sm font-medium text-gray-700 mb-1"},"Sintomas esperados e registrados:",-1)),e("div",ut,[(n(!0),r(p,null,f(D.value.matching,s=>(n(),r("span",{key:s,class:"px-2 py-1 bg-green-100 text-green-700 rounded text-sm"},l(R[s]||s),1))),128))])])):v("",!0),D.value.unexpected.length>0?(n(),r("div",mt,[t[15]||(t[15]=e("p",{class:"text-sm font-medium text-gray-700 mb-1"},"Sintomas não esperados (atenção):",-1)),e("div",gt,[(n(!0),r(p,null,f(D.value.unexpected,s=>(n(),r("span",{key:s,class:"px-2 py-1 bg-amber-100 text-amber-700 rounded text-sm"},l(R[s]||s),1))),128))]),t[16]||(t[16]=e("p",{class:"text-xs text-gray-500 mt-1"}," Estes sintomas não estão tipicamente associados às suas condições cadastradas. Considere mencionar isso ao seu médico. ",-1))])):v("",!0)])]),_:1})):v("",!0)])])):o(S).total>0?(n(),w(o(y),{key:3,class:"!bg-gradient-to-r !from-purple-50 !to-pink-50"},{default:m(()=>[e("div",pt,[e("div",xt,[c(o(P),{class:"w-6 h-6 text-purple-600","aria-hidden":"true"})]),e("div",ft,[t[20]||(t[20]=e("h3",{class:"font-semibold text-gray-900"},"Personalize seus insights",-1)),e("p",yt,[t[18]||(t[18]=x(" Cadastre suas condições de saúde na ",-1)),c(i,{to:"/ficha-medica",class:"text-purple-600 font-medium hover:underline"},{default:m(()=>[...t[17]||(t[17]=[x(" Ficha Médica ",-1)])]),_:1}),t[19]||(t[19]=x(" para ver análises personalizadas baseadas no seu histórico de saúde. ",-1))])])])]),_:1})):v("",!0),e("div",ht,[c(o(y),null,{header:m(()=>[...t[21]||(t[21]=[e("h2",{id:"type-analysis-title",class:"text-lg font-semibold text-gray-900"}," Sintomas por Tipo ",-1)])]),default:m(()=>[C.value.length===0?(n(),r("div",bt," Nenhum dado disponível ")):(n(),r("div",vt,[(n(!0),r(p,null,f(C.value,s=>(n(),r("div",{key:s.id,class:"flex items-center gap-4"},[e("div",{class:_(["w-10 h-10 rounded-lg flex items-center justify-center shrink-0",Z[s.color]])},[(n(),w($(Y[s.icon]),{class:"w-5 h-5","aria-hidden":"true"}))],2),e("div",_t,[e("div",wt,[e("span",kt,l(s.label),1),e("span",St,l(s.count)+" registros",1)]),e("div",Ct,[e("div",{class:"h-full bg-teal-500 rounded-full transition-all",style:L({width:`${s.count/o(S).total*100}%`})},null,4)])])]))),128))]))]),_:1}),c(o(y),null,{header:m(()=>[...t[22]||(t[22]=[e("h2",{id:"weekday-analysis-title",class:"text-lg font-semibold text-gray-900"}," Frequência por Dia da Semana ",-1)])]),default:m(()=>[e("div",Dt,[(n(!0),r(p,null,f(ee.value,s=>(n(),r("div",{key:s.name,class:"flex-1 flex flex-col items-center"},[e("div",Mt,[e("div",{class:"w-full max-w-[32px] bg-teal-500 rounded-t-lg transition-all",style:L({height:s.count>0?`${Math.max(s.percentage,8)}%`:"4px",opacity:s.count>0?1:.3})},null,4)]),e("span",jt,l(s.name.slice(0,3)),1),e("span",It,l(s.count),1)]))),128))])]),_:1}),c(o(y),null,{header:m(()=>[...t[23]||(t[23]=[e("h2",{id:"trend-title",class:"text-lg font-semibold text-gray-900"}," Tendência Semanal ",-1)])]),default:m(()=>[e("div",At,[e("div",Tt,[e("p",Et,l(g.value.lastWeekCount),1),t[24]||(t[24]=e("p",{class:"text-sm text-gray-500"},"Semana passada",-1))]),e("div",$t,[(n(),w($(g.value.trend==="up"?o(E):g.value.trend==="down"?o(O):o(z)),{class:_(["w-8 h-8",g.value.trend==="up"?"text-red-500":g.value.trend==="down"?"text-green-500":"text-gray-400"]),"aria-hidden":"true"},null,8,["class"])),g.value.percentage>0?(n(),r("span",{key:0,class:_(["text-sm font-medium",g.value.trend==="up"?"text-red-600":"text-green-600"])},l(g.value.trend==="up"?"+":"-")+l(g.value.percentage)+"% ",3)):v("",!0)]),e("div",zt,[e("p",Ft,l(g.value.thisWeekCount),1),t[25]||(t[25]=e("p",{class:"text-sm text-teal-600"},"Esta semana",-1))])])]),_:1})]),c(o(y),{class:"!bg-gradient-to-r !from-green-50 !to-blue-50"},{header:m(()=>[e("h2",Vt,[c(o(q),{class:"w-5 h-5 text-green-600","aria-hidden":"true"}),t[26]||(t[26]=x(" Dicas de Saúde ",-1))])]),default:m(()=>[t[27]||(t[27]=e("ul",{class:"space-y-3"},[e("li",{class:"flex items-start gap-3"},[e("span",{class:"w-6 h-6 rounded-full bg-green-100 text-green-600 flex items-center justify-center text-sm font-bold shrink-0"},"1"),e("p",{class:"text-gray-700"},"Mantenha um registro consistente dos seus sintomas para identificar padrões.")]),e("li",{class:"flex items-start gap-3"},[e("span",{class:"w-6 h-6 rounded-full bg-green-100 text-green-600 flex items-center justify-center text-sm font-bold shrink-0"},"2"),e("p",{class:"text-gray-700"},"Compartilhe esses dados com seu médico durante consultas para um diagnóstico mais preciso.")]),e("li",{class:"flex items-start gap-3"},[e("span",{class:"w-6 h-6 rounded-full bg-green-100 text-green-600 flex items-center justify-center text-sm font-bold shrink-0"},"3"),e("p",{class:"text-gray-700"},"Anote nas observações possíveis gatilhos como alimentação, sono ou estresse.")])],-1))]),_:1})],64))])}}};export{Kt as default};
